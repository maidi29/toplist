<div class="before-start">
  <div class="container">
    Share this ID with all players so they can join:
    <div class="share">
      <h2>{{roomId}}</h2>
      <app-share *ngIf="roomId" [gameId]="roomId"></app-share>
    </div>
  </div>
  <hr/>
  <form [formGroup]="questionModeForm" class="question-mode-form">
      <div class="radio-container">
        <input type="radio" id="default" name="questionMode" value="default"
               formControlName="questionMode" class="radio" [ngClass]="{
               'checked': questionModeForm.controls.questionMode.value === 'default'
               }" >
        <label for="default">Play
          <input maxlength="2" type="number" step="1" formControlName="numberRuns" class="number-runs"/>
          full runs where every captain defines a topic per round and guesses the order of the answers.</label>
      </div>
       <div class="radio-container">
        <input type="radio" id="predefined" name="questionMode" value="predefined"
               formControlName="questionMode" class="radio" [ngClass]="{
               'checked': questionModeForm.controls.questionMode.value === 'predefined'
               }" >
        <label for="predefined" class="predefined-label">
          <div>Create a pre-defined game where you set all topics now.
            The current captain guesses the order of the answers.</div>
          <div class="predefined-info">
            {{(allQuestions|| []).length}} topics defined
            <button class="secondary"
                    (click)="
                    questionModeForm.controls.questionMode.setValue('predefined');
                    openPredefinedModal = true;
            ">
              {{(allQuestions || []).length <= 0 ? 'Add' : 'Change'}}
            </button>
          </div>
        </label>
      </div>
  </form>
  <hr/>
  <div class="container">
    <div>Has everyone joined?</div>
    <div *ngIf="(players?.length || 0) < 4">It's recommended to play with at least 4 players</div>
    <app-button (click)="startNewRound()" [autoWidth]="true">Start!</app-button>
  </div>
</div>
<app-modal *ngIf="openPredefinedModal">
  <div class="modal-content">
    <div cdkDropList
         cdkDropListOrientation="vertical"
         [cdkDropListData]="allQuestionsUnsubmitted"
         (cdkDropListDropped)="drop($event)"
         class="drop-container"
    >
        <ng-container *ngFor="let quest of allQuestionsUnsubmitted; let i = index">
          <app-own-question-form *ngIf="quest.open" [playersCount]="(players?.length ||0)+1"
                                 (validSumbit)="quest.text = $event.text;
                                 quest.from= $event.from;
                                 quest.to= $event.to;
                                 quest.open = false"
                                 [prefillFrom]="quest.from" [prefillTo]="quest.to"
                                 [prefillQuestion]="quest.text">
          </app-own-question-form>
          <div class="closed-question" *ngIf="!quest.open" cdkDrag>
            <div>{{quest.text}} - From {{quest.from}} to {{quest.to}}</div>
            <div class="button-container">
              <button class="secondary icon" (click)="quest.open = true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="100%" height="100%"><path d="M 18.414062 2 C 18.158062 2 17.902031 2.0979687 17.707031 2.2929688 L 15.707031 4.2929688 L 14.292969 5.7070312 L 3 17 L 3 21 L 7 21 L 21.707031 6.2929688 C 22.098031 5.9019687 22.098031 5.2689063 21.707031 4.8789062 L 19.121094 2.2929688 C 18.926094 2.0979687 18.670063 2 18.414062 2 z M 18.414062 4.4140625 L 19.585938 5.5859375 L 18.292969 6.8789062 L 17.121094 5.7070312 L 18.414062 4.4140625 z M 15.707031 7.1210938 L 16.878906 8.2929688 L 6.171875 19 L 5 19 L 5 17.828125 L 15.707031 7.1210938 z"/></svg>
              </button>
              <button class="secondary icon" (click)="removeQuestion(i)">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="100%" height="100%"><path d="M 10 2 L 9 3 L 4 3 L 4 5 L 5 5 L 5 20 C 5 20.522222 5.1913289 21.05461 5.5683594 21.431641 C 5.9453899 21.808671 6.4777778 22 7 22 L 17 22 C 17.522222 22 18.05461 21.808671 18.431641 21.431641 C 18.808671 21.05461 19 20.522222 19 20 L 19 5 L 20 5 L 20 3 L 15 3 L 14 2 L 10 2 z M 7 5 L 17 5 L 17 20 L 7 20 L 7 5 z M 9 7 L 9 18 L 11 18 L 11 7 L 9 7 z M 13 7 L 13 18 L 15 18 L 15 7 L 13 7 z"/></svg>
              </button>
            </div>
          </div>
        </ng-container>
    </div>
    <button class="secondary icon" (click)="addUnsubmitted()">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="100%" height="100%"><path d="M 12 2 C 6.4889971 2 2 6.4889971 2 12 C 2 17.511003 6.4889971 22 12 22 C 17.511003 22 22 17.511003 22 12 C 22 6.4889971 17.511003 2 12 2 z M 12 4 C 16.430123 4 20 7.5698774 20 12 C 20 16.430123 16.430123 20 12 20 C 7.5698774 20 4 16.430123 4 12 C 4 7.5698774 7.5698774 4 12 4 z M 11 7 L 11 11 L 7 11 L 7 13 L 11 13 L 11 17 L 13 17 L 13 13 L 17 13 L 17 11 L 13 11 L 13 7 L 11 7 z"/></svg>
    </button>
  </div>
  <div class="modal-footer">
    <app-button (click)="addQuestions(); openPredefinedModal= false">Done</app-button>
  </div>
</app-modal>
